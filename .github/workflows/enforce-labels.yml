name: ðŸ·ï¸ Check Required Labels

on:
  pull_request:
    types: [opened, edited, labeled, unlabeled, synchronize]

jobs:
  check-label:
    name: Enforce Required PR Labels
    runs-on: ubuntu-latest
    steps:
      - name: ðŸš¨ Validate PR labels
        uses: actions/github-script@v7
        with:
          script: |
            const requiredLabels = [
              'non-app-hash-breaking',
              'app-hash-breaking',
              'evm-only',
              'doc-only',
              'chore',
              'security',
              'hotfix',
              'experimental',
              'breaking',
              'allow-override-label'
            ];

            const labels = context.payload.pull_request.labels.map(l => l.name);
            const found = requiredLabels.some(label => labels.includes(label));

            if (!found) {
              core.setFailed("âŒ PR must include at least one classification label.\nRequired labels: " + requiredLabels.join(", "));
            } else {
              console.log("âœ… Valid label found:", labels.find(l => requiredLabels.includes(l)));
            }
